{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019/09/16/193548/","result":{"data":{"site":{"siteMetadata":{"title":"なにもわからない"}},"markdownRemark":{"id":"71b821df-c612-59aa-9d43-f297efa78789","excerpt":"以前、環境変数  が悪さをするバグがあったらしいけど既に解消済みらしい。 https://github.com/docker-library/mysql/issues/82:title 開発時にいちいちホストOS からパスワードを入力してログインするのが面倒で  にこんな設定を書いていた MySQL…","html":"<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ docker-compose up\n...\nmysql_1  | MySQL init process in progress...\nmysql_1  | MySQL init process in progress...\nmysql_1  | MySQL init process in progress...\nmysql_1  | MySQL init process in progress...\nmysql_1  | MySQL init process in progress...\nmysql_1  | MySQL init process failed.</code></pre></div>\n<p>以前、環境変数 <code class=\"language-text\">MYSQL_HOST</code> が悪さをするバグがあったらしいけど既に解消済みらしい。</p>\n<ul>\n<li>[https://github.com/docker-library/mysql/issues/82:title]</li>\n</ul>\n<p>開発時にいちいちホストOS からパスワードを入力してログインするのが面倒で <code class=\"language-text\">/etc/mysql/conf.d/mylogin.cnf</code> にこんな設定を書いていた</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[client]\npassword=&quot;pass&quot;</code></pre></div>\n<p>MySQL コンテナの初期化時に <code class=\"language-text\">[client]</code> が書かれていると <code class=\"language-text\">init process filad.</code> で落ちるのは既知の問題らしい（まぁそりゃそうだ）</p>\n<ul>\n<li>[https://github.com/docker-library/mysql/issues/251:title]</li>\n<li>[https://github.com/docker-library/mysql/issues/82:title]</li>\n</ul>\n<p>パスワードを簡単にするのでもいいけど、<code class=\"language-text\">~/.my.cnf</code> は初期化プロセスに関係しないらしいので置き場所を変えてやればいい。root なのはご愛嬌</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">$ git diff docker-compose.yml\ndiff --git a/docker-compose.yml b/docker-compose.yml\nindex 1d974da..b09d973 100644\n<span class=\"token coord\">--- a/docker-compose.yml</span>\n<span class=\"token coord\">+++ b/docker-compose.yml</span>\n@@ -32,7 +32,7 @@ services:\n<span class=\"token unchanged\">       TZ: Asia/Tokyo\n     volumes:\n       - .:/project:delegated\n</span><span class=\"token deleted-sign deleted\">-      - ./docker/mysql/conf.d/mylogin.cnf:/etc/mysql/conf.d/mylogin.cnf\n</span><span class=\"token inserted-sign inserted\">+      - ./docker/mysql/my.cnf:/root/.my.cnf\n</span><span class=\"token unchanged\">       - ./docker/mysql/initdb.d:/docker-entrypoint-initdb.d\n       - mysql:/var/lib/mysql\n     security_opt:</span></code></pre></div>\n<p>データボリュームの初期化はこう</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">docker-compose down --volumes mysql</code></pre></div>\n<p>init process するスクリプトの本体はこの辺\n[https://github.com/docker-library/mysql/blob/333935aa6612376d58737a8cab0e3f5df370585a/8.0/docker-entrypoint.sh:embed:cite]</p>\n<p>他にもタイムアウト伸ばしたら？とか、メモリ足りないんじゃない？とかいう話もある</p>\n<ul>\n<li>[https://github.com/docker-library/mysql/issues/251#issuecomment-414799052:title]</li>\n<li>[https://github.com/docker-library/mysql/issues/82#issuecomment-204200553:title]</li>\n</ul>","frontmatter":{"title":"MySQL on Docker で MySQL init process failed.","date":"September 16, 2019","description":null}}},"pageContext":{"slug":"/2019/09/16/193548/","previous":{"fields":{"slug":"/2018/06/27/224308/"},"frontmatter":{"title":"Amazon Linux 2 on Amazon Workspaces"}},"next":{"fields":{"slug":"/alpine-docker-oneliner-for-man/"},"frontmatter":{"title":"man したい alpine ワンライナー"}}}}}